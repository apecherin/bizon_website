Some changes by Artem P.
